<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bio-Genetics & Health Hub</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans:wght@400;600&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --primary-color: #2e8b57;
            /* Sea Green */
            --secondary-color: #4CAF50;
            /* Green */
            --accent-color: #bbdefb;
            /* Light Blue */
            --light-bg: #e0f7fa;
            /* Light Cyan */
            --text-color: #333;
            --border-color: #ddd;
            --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            --hover-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
            --border-radius: 10px;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            text-align: center;
            background: linear-gradient(to right, var(--light-bg), var(--accent-color));
            margin: 0;
            padding: 0;
            color: var(--text-color);
            line-height: 1.6;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px 0;
            box-shadow: var(--shadow);
        }

        header h1 {
            margin: 0;
            font-size: 2.5em;
            font-family: 'Roboto', sans-serif;
        }

        nav {
            background-color: var(--secondary-color);
            padding: 10px 0;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            /* Allows buttons to wrap on smaller screens */
        }

        nav button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 25px;
            margin: 8px 10px;
            /* Adjusted margin for responsiveness */
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.0em;
            transition: background-color 0.3s ease, transform 0.2s ease;
            flex-shrink: 0;
            /* Prevents buttons from shrinking */
        }

        nav button:hover {
            background-color: #286d3d;
            /* Darker primary */
            transform: translateY(-2px);
        }

        nav button.active {
            background-color: #1a6f3a;
            /* Even darker to indicate active */
            border-bottom: 3px solid white;
        }

        .container {
            background-color: white;
            margin: 30px auto;
            padding: 40px;
            border-radius: var(--border-radius);
            box-shadow: var(--hover-shadow);
            max-width: 95%;
            /* Wider container for larger screens */
            width: 900px;
            /* Fixed width for larger screens */
            text-align: left;
            box-sizing: border-box;
            /* Include padding in width */
        }

        h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--light-bg);
            padding-bottom: 10px;
            margin-top: 0;
            font-family: 'Roboto', sans-serif;
            font-size: 2em;
        }

        .feature-section {
            display: none;
            padding-top: 20px;
        }

        .feature-section.active {
            display: block;
        }

        input[type="text"],
        input[type="number"],
        select {
            padding: 12px;
            margin: 10px 0;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1em;
            width: calc(100% - 24px);
            /* Account for padding */
            box-sizing: border-box;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            border-color: var(--primary-color);
            outline: none;
        }

        button.action-button {
            background-color: var(--secondary-color);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.3s ease, transform 0.2s ease;
            display: block;
            width: 100%;
            margin-top: 20px;
        }

        button.action-button:hover {
            background-color: var(--primary-color);
            transform: translateY(-2px);
        }

        table {
            margin: 20px auto;
            border-collapse: collapse;
            width: 100%;
        }

        th,
        td {
            border: 2px solid var(--primary-color);
            padding: 15px;
            font-size: 1.1em;
            text-align: center;
        }

        th {
            background-color: var(--light-bg);
        }

        #punnettResults,
        #bloodPredictorResults,
        #donationResult,
        #bmiResult,
        #bmrResult {
            margin-top: 30px;
            padding: 20px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #eee;
        }

        .blood-group-input {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            margin-bottom: 20px;
        }

        .blood-group-input label {
            flex: 1;
            min-width: 100px;
            /* Smaller min-width for labels */
            font-weight: bold;
        }

        .blood-group-input select {
            flex: 2;
            min-width: 120px;
            /* Smaller min-width for selects */
            width: auto;
            /* Override 100% width from general input styling */
        }

        /* --- Responsive Design --- */
        @media (max-width: 768px) {
            header h1 {
                font-size: 2em;
            }

            nav button {
                padding: 10px 18px;
                margin: 5px;
                font-size: 0.9em;
            }

            .container {
                padding: 20px;
                margin: 20px auto;
                width: 95%;
                /* Make it fill more of the screen on smaller devices */
            }

            h2 {
                font-size: 1.6em;
            }

            input[type="text"],
            input[type="number"],
            select,
            button.action-button {
                font-size: 0.95em;
                padding: 10px;
            }

            th,
            td {
                padding: 10px;
                font-size: 1em;
            }

            .blood-group-input {
                flex-direction: column;
                /* Stack inputs vertically */
                align-items: flex-start;
            }

            .blood-group-input label,
            .blood-group-input select {
                width: 100%;
                min-width: unset;
            }
        }

        @media (max-width: 480px) {
            header h1 {
                font-size: 1.8em;
            }

            nav button {
                width: calc(50% - 20px);
                /* Two buttons per row */
                margin: 5px 10px;
            }

            .container {
                padding: 15px;
                margin: 15px auto;
            }

            h2 {
                font-size: 1.4em;
            }
        }
    </style>
</head>

<body>
    <header>
        <h1>Bio-Genetics & Health Hub</h1>
    </header>

    <nav>
        <button id="navPunnett" onclick="showSection('punnettSquare', this)">Punnett Square</button>
        <button id="navBloodDonation" onclick="showSection('bloodDonation', this)">Blood Donation Check</button>
        <button id="navBloodPredictor" onclick="showSection('bloodPredictor', this)">Blood Group Predictor</button>
        <button id="navBMICalculator" onclick="showSection('bmiCalculator', this)">BMI Calculator</button>
        <button id="navBMRCalculator" onclick="showSection('bmrCalculator', this)">BMR Calculator</button>
    </nav>

    <div class="container">
        <div id="punnettSquare" class="feature-section active">
            <h2>Punnett Square Generator</h2>
            <p>Enter the 2-letter genotypes for each parent (e.g., Aa, BB, tt) to generate a Punnett Square and see the
                genotype ratios.</p>
            <label for="p1Punnett">Parent 1 Genotype (e.g., Aa): </label>
            <input type="text" id="p1Punnett" maxlength="2" placeholder="e.g., Aa">
            <label for="p2Punnett">Parent 2 Genotype (e.g., Aa): </label>
            <input type="text" id="p2Punnett" maxlength="2" placeholder="e.g., Aa">
            <button class="action-button" onclick="generatePunnettSquare()">Generate Punnett Square</button>
            <div id="punnettResults"></div>
        </div>

        <div id="bloodDonation" class="feature-section">
            <h2>Blood Donation Eligibility Checker</h2>
            <p>Check if you're eligible to donate blood based on common criteria. Please note this is for informational
                purposes only and not a substitute for professional medical advice.</p>

            <label for="donorBloodGroup">Your Blood Group:</label>
            <select id="donorBloodGroup">
                <option value="">Select Blood Group</option>
                <option value="A+">A+</option>
                <option value="A-">A-</option>
                <option value="B+">B+</option>
                <option value="B-">B-</option>
                <option value="AB+">AB+</option>
                <option value="AB-">AB-</option>
                <option value="O+">O+</option>
                <option value="O-">O-</option>
            </select>

            <label for="age">Your Age:</label>
            <input type="number" id="age" min="17" max="65" placeholder="Enter your age">

            <label for="weight">Your Weight (kg):</label>
            <input type="number" id="weight" min="50" placeholder="Enter your weight in kg">

            <label for="healthStatus">Any major health conditions (e.g., diabetes, heart disease)?</label>
            <select id="healthStatus">
                <option value="no">No</option>
                <option value="yes">Yes</option>
            </select>

            <label for="lastDonation">When was your last blood donation?</label>
            <select id="lastDonation">
                <option value="">Select an option</option>
                <option value="never">Never donated</option>
                <option value="lessThan3">Less than 3 months ago</option>
                <option value="3to6">3-6 months ago</option>
                <option value="moreThan6">More than 6 months ago</option>
            </select>

            <button class="action-button" onclick="checkBloodDonation()">Check Eligibility</button>
            <div id="donationResult"></div>
        </div>

        <div id="bloodPredictor" class="feature-section">
            <h2>Parent to Child Blood Group Predictor</h2>
            <p>Select the blood groups of both parents to predict the possible blood groups of their child.</p>

            <div class="blood-group-input">
                <label for="parent1Blood">Parent 1 Blood Group:</label>
                <select id="parent1Blood">
                    <option value="">Select Blood Group</option>
                    <option value="A">A</option>
                    <option value="B">B</option>
                    <option value="AB">AB</option>
                    <option value="O">O</option>
                </select>
                <label for="parent1Rh">Parent 1 Rh Factor:</label>
                <select id="parent1Rh">
                    <option value="+">+</option>
                    <option value="-">-</option>
                </select>
            </div>

            <div class="blood-group-input">
                <label for="parent2Blood">Parent 2 Blood Group:</label>
                <select id="parent2Blood">
                    <option value="">Select Blood Group</option>
                    <option value="A">A</option>
                    <option value="B">B</option>
                    <option value="AB">AB</option>
                    <option value="O">O</option>
                </select>
                <label for="parent2Rh">Parent 2 Rh Factor:</label>
                <select id="parent2Rh">
                    <option value="+">+</option>
                    <option value="-">-</option>
                </select>
            </div>

            <button class="action-button" onclick="predictChildBloodGroup()">Predict Child's Blood Group</button>
            <div id="bloodPredictorResults"></div>
        </div>

        <div id="bmiCalculator" class="feature-section">
            <h2>BMI Calculator</h2>
            <p>Enter your weight in kilograms and height in centimeters to calculate your Body Mass Index (BMI).</p>
            <label for="bmiWeight">Weight (kg):</label>
            <input type="number" id="bmiWeight" min="1" placeholder="Enter your weight in kg">
            <label for="bmiHeight">Height (cm):</label>
            <input type="number" id="bmiHeight" min="1" placeholder="Enter your height in cm">
            <button class="action-button" onclick="calculateBMI()">Calculate BMI</button>
            <div id="bmiResult"></div>
        </div>

        <div id="bmrCalculator" class="feature-section">
            <h2>BMR & TDEE Calculator</h2>
            <p>Enter your weight, height, age, and gender to calculate your Basal Metabolic Rate (BMR) and Total Daily
                Energy Expenditure (TDEE).</p>
            <label for="bmrWeight">Weight (kg):</label>
            <input type="number" id="bmrWeight" min="1" placeholder="Enter your weight in kg">
            <label for="bmrHeight">Height (cm):</label>
            <input type="number" id="bmrHeight" min="1" placeholder="Enter your height in cm">
            <label for="bmrAge">Age:</label>
            <input type="number" id="bmrAge" min="1" placeholder="Enter your age">
            <label for="bmrGender">Gender:</label>
            <select id="bmrGender">
                <option value="male">Male</option>
                <option value="female">Female</option>
            </select>
            <label for="activityLevel">Activity Level:</label>
            <select id="activityLevel">
                <option value="1.2">Sedentary (little or no exercise)</option>
                <option value="1.375">Lightly active (light exercise/sports 1-3 days/week)</option>
                <option value="1.55">Moderately active (moderate exercise/sports 3-5 days/week)</option>
                <option value="1.725">Very active (hard exercise/sports 6-7 days/week)</option>
                <option value="1.9">Extra active (very hard exercise/physical job)</option>
            </select>
            <button class="action-button" onclick="calculateBMRAndTDEE()">Calculate BMR & TDEE</button>
            <div id="bmrResult"></div>
        </div>

    </div>

    <script>
        // --- Navigation Functionality ---
        function showSection(sectionId, clickedButton) {
            document.querySelectorAll('.feature-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(sectionId).classList.add('active');

            // Update active button styling
            document.querySelectorAll('nav button').forEach(button => {
                button.classList.remove('active');
            });
            if (clickedButton) {
                clickedButton.classList.add('active');
            }
        }

        // --- Punnett Square Generator (Improved) ---
        function generatePunnettSquare() {
            const p1 = document.getElementById("p1Punnett").value.trim();
            const p2 = document.getElementById("p2Punnett").value.trim();
            const resultsDiv = document.getElementById("punnettResults");
            resultsDiv.innerHTML = ''; // Clear previous results

            if (p1.length !== 2 || p2.length !== 2 || !/^[a-zA-Z]{2}$/.test(p1) || !/^[a-zA-Z]{2}$/.test(p2)) {
                resultsDiv.innerHTML = '<p style="color: red;">Please enter 2-letter genotypes for both parents (e.g., Aa, AA, bb). Only letters allowed.</p>';
                return;
            }

            const alleles1 = [p1.charAt(0), p1.charAt(1)];
            const alleles2 = [p2.charAt(0), p2.charAt(1)];

            let tableHTML = `<table><tr><th></th><th>${alleles2[0]}</th><th>${alleles2[1]}</th></tr>`;

            const results = {}; // To store genotype counts

            for (let i = 0; i < 2; i++) {
                tableHTML += `<tr><th>${alleles1[i]}</th>`;
                for (let j = 0; j < 2; j++) {
                    let combo = alleles1[i] + alleles2[j];
                    combo = combo.split('').sort((a, b) => {
                        // Sort to ensure dominant allele (uppercase) comes first, then alphabetical
                        if (a.toUpperCase() === b.toUpperCase()) return a.localeCompare(b);
                        return a.charCodeAt(0) - b.charCodeAt(0);
                    }).join(''); // Sort to standardize (e.g., aA becomes Aa, Bb becomes Bb)
                    results[combo] = (results[combo] || 0) + 1;
                    tableHTML += `<td>${combo}</td>`;
                }
                tableHTML += '</tr>';
            }

            tableHTML += '</table>';

            let summaryHTML = "<h3>Genotype Ratio:</h3><ul>";
            for (const [genotype, count] of Object.entries(results)) {
                summaryHTML += `<li>${genotype}: ${count}/4 (${(count / 4 * 100).toFixed(0)}%)</li>`;
            }
            summaryHTML += "</ul>";

            resultsDiv.innerHTML = tableHTML + summaryHTML;
        }

        // --- Blood Donation Eligibility Checker ---
        function checkBloodDonation() {
            const bloodGroup = document.getElementById('donorBloodGroup').value;
            const age = parseInt(document.getElementById('age').value);
            const weight = parseFloat(document.getElementById('weight').value);
            const healthStatus = document.getElementById('healthStatus').value;
            const lastDonation = document.getElementById('lastDonation').value; // Changed to string for options
            const donationResultDiv = document.getElementById('donationResult');
            donationResultDiv.innerHTML = ''; // Clear previous results

            let eligible = true;
            let reasons = [];

            if (!bloodGroup) {
                eligible = false;
                reasons.push("Please select your blood group.");
            }
            if (isNaN(age) || age < 17 || age > 65) {
                eligible = false;
                reasons.push("Age must be between 17 and 65 years (typical range for donation).");
            }
            if (isNaN(weight) || weight < 50) {
                eligible = false;
                reasons.push("Weight must be at least 50 kg (approx. 110 lbs).");
            }
            if (healthStatus === 'yes') {
                eligible = false;
                reasons.push("Major health conditions often disqualify donors. Consult a doctor.");
            }

            // Handle "Never donated" and donation intervals
            if (lastDonation === '') {
                eligible = false;
                reasons.push("Please select an option for your last blood donation.");
            } else if (lastDonation === 'lessThan3') {
                eligible = false;
                reasons.push("You must wait at least 3 months (approx. 12 weeks) since your last donation.");
            }

            if (eligible) {
                donationResultDiv.innerHTML = '<p style="color: green; font-weight: bold;">&#10004; You are likely eligible to donate blood! Always consult a medical professional or blood bank for definitive eligibility.</p>';
            } else {
                let reasonList = reasons.length > 0 ? `<p>Reasons for potential ineligibility:</p><ul>${reasons.map(r => `<li>${r}</li>`).join('')}</ul>` : '<p>Please fill out all fields correctly.</p>';
                donationResultDiv.innerHTML = `<p style="color: red; font-weight: bold;">&#10060; You may not be eligible to donate blood at this time.</p>${reasonList}<p>Always consult with a healthcare professional or blood donation center for definitive eligibility.</p>`;
            }
        }

        // --- Parent to Child Blood Group Predictor ---
        function predictChildBloodGroup() {
            const p1Blood = document.getElementById('parent1Blood').value;
            const p1Rh = document.getElementById('parent1Rh').value;
            const p2Blood = document.getElementById('parent2Blood').value;
            const p2Rh = document.getElementById('parent2Rh').value;
            const predictorResultsDiv = document.getElementById('bloodPredictorResults');
            predictorResultsDiv.innerHTML = '';

            if (!p1Blood || !p1Rh || !p2Blood || !p2Rh) {
                predictorResultsDiv.innerHTML = '<p style="color: red;">Please select blood groups and Rh factors for both parents.</p>';
                return;
            }

            const possibleABO = getPossibleABO(p1Blood, p2Blood);
            const possibleRh = getPossibleRh(p1Rh, p2Rh);

            let resultHTML = "<h3>Possible Child Blood Groups:</h3><ul>";
            if (possibleABO.length === 0 || possibleRh.length === 0) {
                resultHTML += "<li>Cannot determine with given inputs.</li>";
            } else {
                possibleABO.forEach(abo => {
                    possibleRh.forEach(rh => {
                        resultHTML += `<li>${abo}${rh}</li>`;
                    });
                });
            }
            resultHTML += "</ul><p>This prediction is based on standard Mendelian inheritance. Actual outcomes may vary. Consult a medical professional for genetic counseling.</p>";
            predictorResultsDiv.innerHTML = resultHTML;
        }

        // Helper function for ABO prediction
        function getPossibleABO(parent1, parent2) {
            // Possible genotypes for each phenotype
            const phenotypes = {
                'A': ['A', 'O'], // Can be AA or AO
                'B': ['B', 'O'], // Can be BB or BO
                'AB': ['A', 'B'], // Only AB
                'O': ['O', 'O']  // Only OO
            };

            const p1Alleles = phenotypes[parent1];
            const p2Alleles = phenotypes[parent2];

            const possibleCombos = new Set(); // Use a Set to store unique results

            for (let i = 0; i < p1Alleles.length; i++) {
                for (let j = 0; j < p2Alleles.length; j++) {
                    const combo = p1Alleles[i] + p2Alleles[j];
                    // Determine resulting phenotype
                    if (combo.includes('A') && combo.includes('B')) {
                        possibleCombos.add('AB');
                    } else if (combo.includes('A')) {
                        possibleCombos.add('A');
                    } else if (combo.includes('B')) {
                        possibleCombos.add('B');
                    } else if (combo.includes('O') && combo.length === 2) { // Both are 'O'
                        possibleCombos.add('O');
                    }
                }
            }
            return Array.from(possibleCombos).sort();
        }

        // Helper function for Rh prediction
        function getPossibleRh(parent1Rh, parent2Rh) {
            // + is dominant, - is recessive
            // ++ => homozygous dominant
            // +- => heterozygous
            // -- => homozygous recessive

            const p1PossibleGenotypes = parent1Rh === '+' ? ['++', '+-'] : ['--'];
            const p2PossibleGenotypes = parent2Rh === '+' ? ['++', '+-'] : ['--'];

            const possibleRhFactors = new Set();

            p1PossibleGenotypes.forEach(g1 => {
                p2PossibleGenotypes.forEach(g2 => {
                    const alleles1 = [g1[0], g1[1]];
                    const alleles2 = [g2[0], g2[1]];

                    const combos = [
                        alleles1[0] + alleles2[0],
                        alleles1[0] + alleles2[1],
                        alleles1[1] + alleles2[0],
                        alleles1[1] + alleles2[1]
                    ];

                    combos.forEach(c => {
                        if (c.includes('+')) { // If any '+' allele is present, it's Rh positive
                            possibleRhFactors.add('+');
                        } else { // Only if both are '-' is it Rh negative
                            possibleRhFactors.add('-');
                        }
                    });
                });
            });
            return Array.from(possibleRhFactors).sort();
        }

        // --- BMI Calculator ---
        function calculateBMI() {
            const weight = parseFloat(document.getElementById('bmiWeight').value);
            const heightCm = parseFloat(document.getElementById('bmiHeight').value);
            const bmiResultDiv = document.getElementById('bmiResult');
            bmiResultDiv.innerHTML = '';

            if (isNaN(weight) || isNaN(heightCm) || weight <= 0 || heightCm <= 0) {
                bmiResultDiv.innerHTML = '<p style="color: red;">Please enter valid positive numbers for weight and height.</p>';
                return;
            }

            const heightM = heightCm / 100; // Convert cm to meters
            const bmi = weight / (heightM * heightM);
            let category = '';

            if (bmi < 18.5) {
                category = 'Underweight';
            } else if (bmi >= 18.5 && bmi <= 24.9) {
                category = 'Normal weight';
            } else if (bmi >= 25 && bmi <= 29.9) {
                category = 'Overweight';
            } else {
                category = 'Obesity';
            }

            bmiResultDiv.innerHTML = `<p>Your BMI is: <strong>${bmi.toFixed(2)}</strong></p><p>Category: <strong>${category}</strong></p>`;
        }

        // --- BMR & TDEE Calculator ---
        function calculateBMRAndTDEE() {
            const weight = parseFloat(document.getElementById('bmrWeight').value);
            const heightCm = parseFloat(document.getElementById('bmrHeight').value);
            const age = parseInt(document.getElementById('bmrAge').value);
            const gender = document.getElementById('bmrGender').value;
            const activityLevel = parseFloat(document.getElementById('activityLevel').value);
            const bmrResultDiv = document.getElementById('bmrResult');
            bmrResultDiv.innerHTML = '';

            if (isNaN(weight) || isNaN(heightCm) || isNaN(age) || weight <= 0 || heightCm <= 0 || age <= 0) {
                bmrResultDiv.innerHTML = '<p style="color: red;">Please enter valid positive numbers for weight, height, and age.</p>';
                return;
            }

            let bmr;
            // Mifflin-St Jeor Equation
            if (gender === 'male') {
                bmr = (10 * weight) + (6.25 * heightCm) - (5 * age) + 5;
            } else { // female
                bmr = (10 * weight) + (6.25 * heightCm) - (5 * age) - 161;
            }

            const tdee = bmr * activityLevel;

            bmrResultDiv.innerHTML = `<p>Your Basal Metabolic Rate (BMR) is: <strong>${bmr.toFixed(2)} calories/day</strong></p><p>Your Total Daily Energy Expenditure (TDEE) is approximately: <strong>${tdee.toFixed(2)} calories/day</strong></p><p>BMR is the calories your body needs at rest. TDEE includes calories burned through activity.</p>`;
        }


        document.addEventListener('DOMContentLoaded', () => {
            // Set Punnett Square as default active section and button
            showSection('punnettSquare', document.getElementById('navPunnett'));
        });
    </script>
</body>

</html>